# 📘 Product Requirements Document (PRD)
## 서비스명: 감사일기 with AI 한줄 일기 (완성 버전)

---

## 🔍 목적

사용자가 매일 3가지 감사한 일을 감정과 함께 기록하면,  
Gemini-2.0-Flash를 통해 한줄 일기를 작성해주고, 
월간 감정 변화와 감사 습관을 시각적으로 리포팅하여  
감정 자각, 자기 돌봄, 긍정 감정 지속을 도와주는 심리 코칭형 감사일기 서비스.

---

## 🧱 핵심 기능 요약 (완성된 기능)

### 1. 사용자 인증 시스템 ✅
- **Supabase Auth 연동**: 이메일 로그인 시스템
- **세션 관리**: 자동 로그인 상태 유지
- **로그아웃**: 안전한 세션 종료
- **사용자별 데이터 분리**: 개인별 감사일기 데이터 관리

---

### 2. 감사일기 입력 인터페이스 ✅
- **날짜 선택 필드**: 원하는 날짜에 일기 작성 가능
- **동적 감사 항목**: 나, 타인, 상황에 대한 감사 기록 (각 항목별 여러 입력 가능)
- **감정 선택**: 6가지 감정 중 선택 (행복, 기쁨, 뿌듯, 편안, 피곤, 우울)
- **실시간 저장**: 작성된 일기는 `Supabase`에 실시간 저장

---

### 3. Gemini API Key 관리 ✅
- **API 키 입력**: 사용자가 본인의 Gemini 2.0 Flash API 키를 직접 입력
- **로컬 저장**: API 키는 `localStorage`에 저장되어 새로고침해도 유지
- **키 유효성 검증**: API 키 입력 시 즉시 유효성 확인
- **UI 상태 관리**: 키 등록 및 저장 상태를 실시간으로 확인 가능

---

### 4. AI 한줄일기 생성 ✅
- **감정 기반 프롬프트**: 사용자의 입력을 감정에 맞게 구성하여 Gemini API에 전달
- **문학적 요약**: 각 항목을 바탕으로 한줄 일기 요약 1문장 생성 (40자 내외)
- **감정별 차별화**: 감정에 따라 요약 결과 방식이 달라짐

#### AI 한줄일기 생성 규칙:

| 감정군 | 요약 구성 | 특징 |
|--------|------------|------|
| 행복/기쁨 | 가치/행동/선택 중심 + 잔잔한 응원 톤 | 밝고 따뜻한 말투 |
| 피곤/우울 | 심리적 추론 + 조용히 받아들이는 어조 | 공감적이고 차분한 말투 |
| 편안/뿌듯 | 현재 상태 수용 + 정서 유지 지지 | 유머러스하고 부드러운 말투 |

- 모든 응답은 40자 내외 × 1문장
- 문체는 담백하고 따뜻하게, 문학적 여운을 가볍게 풍기도록
- 감정은 직접 언급하지 말고 어조·단어·뉘앙스로 정서적 암시

---

### 5. 일기 저장 및 조회 ✅
- **Supabase 연동**: 날짜별 감사일기,감정,AI요약을 `Supabase`DB에 저장
- **실시간 동기화**: 여러 기기에서 동일한 데이터 접근 가능
- **데이터 구조**:
  - 날짜 (date)
  - 감정 (emotion)
  - 감사 항목들 (items: title, content, order_index)
  - AI 한줄 일기 요약 (summary)
  - 사용자 ID (user_id)
  - 생성 시간 (created_at)

---

### 6. 일기 관리 시스템 ✅
- **일기 목록**: 작성한 모든 일기를 날짜순으로 확인 (감정과 한줄 요약 표시)
- **일기 수정**: 기존 일기 수정 및 업데이트
- **일기 삭제**: 선택한 일기 완전 삭제
- **실시간 업데이트**: 수정/삭제 시 즉시 목록 반영

---

### 7. 월간 감정 리포트 기능 ✅
- **월별 데이터 수집**: 사용자가 한 달간 작성한 감사일기에서 감정 데이터 수집
- **통계 분석**: 자동 생성된 월간 리포트 제공

#### 📊 리포트 구성 요소
- **감정 분포 차트**: 파이차트로 월별 감정 분포 시각화
- **가장 자주 등장한 감정**: 월간 감정 패턴 분석
- **긍정률 계산**: 긍정감정(행복, 기쁨) 일기 비율
- **기록률**: 월간 일기 작성 빈도 분석
- **리포트 요약**: "이번 달, 당신은 X일의 감사일기를 기록했고, Y%의 날에 긍정적인 감정을 느꼈어요."

#### 리포트 페이지 특성:
- 해당 월 선택 가능
- 전체 일기 리스트도 미니 형태로 열람 가능
- 감정별 색상 테마 적용

---

### 8. 반응형 UI/UX ✅
- **모바일 최적화**: 모바일/태블릿/데스크톱 모든 기기 지원
- **감정별 색상 테마**: 6가지 감정에 따른 시각적 피드백
- **애니메이션**: 부드러운 등장 효과, 감정별 맥박 효과
- **로딩 상태**: API 호출 시 사용자 피드백
- **에러 처리**: 친화적인 에러 메시지 및 복구 가이드

---

## 🔧 기술 스택 (실제 구현)

| 기능 | 기술 |
|------|------|
| 프론트엔드 | React 18 + TypeScript |
| 상태관리 | React Hooks + TanStack Query |
| 라우팅 | React Router DOM |
| 저장 | Supabase (Auth + Database) |
| API 연동 | Gemini-2.0-Flash API (Google AI Studio) |
| 차트/리포트 | Recharts |
| 스타일링 | Tailwind CSS + shadcn/ui |
| 날짜 처리 | date-fns |
| 배포 | Vite (개발), Vercel (배포) |

---

## 🚧 개발 완료 현황

### ✅ 1단계: 기본 MVP (완료)
- [x] 사용자 인증 시스템 (Supabase Auth)
- [x] 감사일기 입력 폼 (동적 항목 지원)
- [x] 감정 선택 (6가지 감정)
- [x] Gemini API Key 등록 및 저장
- [x] Gemini 응답 출력
- [x] 날짜 필드 추가 (원하는 날짜 선택)
- [x] 일기 클라우드 저장 (Supabase)
- [x] 일기 목록 UI 구성 (날짜별 정렬)

### ✅ 2단계: 정서 피드백 & UX 개선 (완료)
- [x] 감정별 색상 테마 적용
- [x] 로딩 애니메이션
- [x] 감정별 문체 tone 조정
- [x] 에러 처리 및 키 유효성 확인
- [x] 반응형 UI (모바일/데스크톱)
- [x] 사용자 피드백 시스템

### ✅ 3단계: 감정 통계 리포트 기능 (완료)
- [x] 감정별 통계 수집 (Supabase 기반)
- [x] 월간 리포트 UI 페이지 구성
- [x] 감정 차트, 긍정률 계산
- [x] 월 선택 드롭다운
- [x] 리포트 요약 코멘트 자동 생성

### ✅ 4단계: 고급 기능 (완료)
- [x] 일기 수정 및 삭제 기능
- [x] 동적 감사 항목 (각 항목별 여러 입력)
- [x] 실시간 데이터 동기화
- [x] TypeScript 타입 안전성
- [x] 에러 처리 및 사용자 피드백
- [x] 로딩 상태 관리

---

## 🔄 향후 개발 계획

### 단기 계획 (1-2개월)
- [ ] **날씨 테마 적용**: 감정을 직관적인 날씨로 표현
- [ ] **노션 데이터 MCP 적용** : 노션에 작성한 내용을 가지고 오기
- [ ] **알림 기능**: 일기 작성 리마인더

### 중기 계획 (3-6개월)
- [ ] **모바일 앱**: React Native 네이티브 앱 개발
- [ ] **소셜 기능**: 친구와 감사 공유 (선택적)
- [ ] **유료화 기능****: 개인화된 AI요약,더 정교한 감정 패턴 분석
- [ ] **데이터 백업/복원**: CSV 내보내기 기능

### 장기 계획 (6개월+)
- [ ] **음성 입력**: 음성으로 감사일기 작성
- [ ] **이미지 업로드**: 감사한 순간 사진 첨부

---

## 📎 Gemini Prompt 구성 (실제 구현)

```
당신은 감정에 섬세하게 반응하는 고급 감성 작가입니다.

사용자는 하루 동안 다음 정보를 기록했습니다:
- 감사한 일들 (나/타인/상황에 대한 여러가지 감사항목)
- 감정 (하루의 전반적인 정서: 행복, 뿌듯, 기쁨, 편안, 피곤, 우울 중 하나)

당신의 역할은 이 정보를 바탕으로, **사용자의 하루를 1문장(40자 내외)**으로 요약하는 것입니다.

## ✅ 반드시 반영할 요소:
1. **가장 많이 입력한 감사 항목**에 대해 집중적으로 요약할 것
2. 실제로 일어난 일 또는 구체적인 행동 또는 인물을 요약 안에 포함
3. 그 일이 사용자의 하루에 어떤 의미였는지를 간접적으로 묘사
4. 감정은 직접 언급하지 말고, 문장의 어조·단어·뉘앙스를 통해 정서적으로 암시
5. 문장은 반드시 40자 내외, 1문장, 느낌표/의문문/말줄임표 없이 작성
6. 말투는 밝고 긍정적이면서 따뜻하게, 유머는 유쾌하고 솔직하게, 희망적인 미래를 암시하도록

## 감정별 톤 가이드:
- 행복/기쁨: 가치/행동/선택 중심 + 잔잔한 응원 톤
- 피곤/우울: 심리적 추론 + 조용히 받아들이는 어조  
- 편안/뿌듯: 현재 상태 수용 + 유머러스한 톤
```

---

## ✅ 성공 기준 (Success Criteria)

### 핵심 지표
- 서비스 사용자 수 확인
- 무료->유료 전환 설계 경험 (부분 유료화 결제)
- 월간 보고서를 통해 2회 이상 감정 패턴을 돌아본 사용자 비율 ≥ 50%
- 1주 이상 연속 기록 사용자 비율 ≥ 40

### 사용자 경험
- [x] 직관적인 일기 작성 인터페이스
- [x] 감정별 시각적 피드백
- [x] 월간 감정 리포트 시각화
- [x] 안전한 데이터 저장 및 관리

---
